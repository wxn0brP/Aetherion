var o=(t,e)=>()=>(t&&(e=t(t=0)),e);async function h(t,e={},n={},r={}){let{transport:i,hooks:a}=l,g=Date.now();try{n=Object.assign({},l.hookContext,e,n),a.onStart?.(t,n),typeof t=="string"&&Object.keys(e).length&&(t={query:t,var:e});let s=await i(t,r),y=Date.now()-g;if(a.onEnd?.(t,y,s,n),s?.err){let w=new Error(s.err);throw a.onError?.(t,w,s,n),w}return s.result!==void 0?s.result:s}catch(s){throw a.onError?.(t,s,null,n),s}}async function M(t,e){let n=Object.assign({"Content-Type":"application/json"},l.headers,e.headers),r=Object.assign({},l.body,e.body,{query:t}),i={method:"POST",headers:n,body:JSON.stringify(r)};e.signal&&(i.signal=e.signal);let a=await l.fetchImplementation(l.url,i);if(!a.ok)throw new Error(`VQL request failed: ${a.status}`);return await a.json()}var l,U,b=o(()=>{l={transport:M,fetchImplementation:(t,e)=>fetch(t,e),hooks:{},url:"/VQL"};U=async(t,...e)=>{let n=t.map((r,i)=>r.trim()+(e[i]!==void 0?e[i]:"")).join(" ");return h(n)};typeof window<"u"&&(window.VQLClient={fetchVQL:h,defTransport:M,VQL:U,cfg:l})});function p(t){return new Promise(e=>setTimeout(e,t))}var x=o(()=>{});var E=o(()=>{});var j=o(()=>{E()});var Y={};var X,c,v,F=o(async()=>{x();b();X=await h("api startup-logs"),c=qs("#startup-logs");c.style.display="";for(let t of X){await new Promise(n=>setTimeout(n,t.time*10));let e=document.createElement("div");e.innerHTML=t.msg.replace(/\n/g,"<br/>"),c.appendChild(e),c.scrollTop=c.scrollHeight}v=document.createElement("div");c.appendChild(v);c.scrollTop=c.scrollHeight;for(let t=0;t<4;t++)await p(300),v.innerHTML+=".";await p(300);v.innerHTML="Ready!";await p(430);c.style.display="none";c.innerHTML=""});var Z={};var O,C=o(async()=>{x();O=qs("#startup-hi");O.css("display","");await p(3e3);await O.fadeOutP()});var tt={};var H=o(async()=>{x();j();await p(500);await F().then(()=>Y);await C().then(()=>Z)});var q=o(()=>{});var S=o(()=>{q()});async function Q(){_(D)}async function _(t){V.innerHTML=et(await nt(t))}function et(t){return[{name:"..",d:!0},...t].map(({name:e,d:n})=>{let r="",i=n?"dir":"file";return r+=`<div class="entry" data-dir="${n}" data-name="${e}">`,r+=`<img class="${i}" src="img/${i}.svg" alt="${i}: ">`,r+=e,r+="</div>",r}).join("")}async function nt(t){return h("api list-files s.path=$path",{path:t})}function rt(...t){let n=t.filter(r=>r!=="").map(r=>r.replace(/[\/\\]+/g,"/")).map(r=>r.replace(/^\/+|\/+$/g,"")).join("/");return t.length>0&&t[0].startsWith("/")&&(n="/"+n),t.length>0&&t[t.length-1].endsWith("/")&&(n=n+"/"),n}var V,D,L,$=o(async()=>{b();S();V=qs("#filesPanel"),D=await h("api home!"),L=D;V.addEventListener("click",t=>{let n=t.target.closest(".entry");if(!n)return;n.dataset.dir&&(L=rt(L,n.dataset.name),_(L))})});var A=o(()=>{});var I=o(()=>{A()});async function R(){ot()}function m(t){let e=document.createElement("div");e.classList.add("row");for(let n of t){let r=document.createElement("div");r.innerHTML=n,e.appendChild(r)}return e}function ot(){d.innerHTML="",d.appendChild(m(["Esc","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12"])),d.appendChild(m(["`","1","2","3","4","5","6","7","8","9","0","-","=","Backspace"])),d.appendChild(m(["Tab","q","w","e","r","t","y","u","i","o","p","[","]","\\"])),d.appendChild(m(["Caps","a","s","d","f","g","h","j","k","l",";","'","Enter"])),d.appendChild(m(["Shift","z","x","c","v","b","n","m",",",".","/","Shift"])),d.appendChild(m(["Ctrl","Meta","Alt","___","AltG","Ctrl"])),u(110,1,-1),u(30,2,0),u(60,2,-1),u(50,3,0),u(160,3,-1),u(140,4,0),u(200,4,-1),u(500,5,3)}function at(...t){let e=d.children[t[0]];for(let n=1;n<t.length;n++)e=[...e.children].at(t[n]);return e}function u(t,...e){at(...e).style.width=100+t+"%"}function T(t,e){d.querySelectorAll(".row div").forEach(n=>{n.innerHTML.toLowerCase()===t&&n.classList.toggle("pressed",e)})}function z(t){return it[t]||t}function st(t){t==="meta"&&setTimeout(()=>{T("meta",!1)},1e3)}var d,it,G=o(()=>{I();d=qs("#keyboardPanel"),it={control:"ctrl"," ":"___",escape:"esc",capslock:"caps",altgraph:"altg"};document.addEventListener("keydown",t=>{let e=z(t.key.toLowerCase());console.log(e),st(e),T(e,!0)});document.addEventListener("keyup",t=>{let e=z(t.key.toLowerCase());T(e,!1)})});var K=o(()=>{});var N=o(()=>{K()});var lt={};var B=o(async()=>{await $();G();N();await qs("main").fadeInP("");Q();R()});var f={html(t){return t!==void 0?(this.innerHTML=t,this):this.innerHTML},v(t){return t!==void 0?(this.value=t,this):this.value},on(t,e){return this.addEventListener(t,e),this},css(t,e=null){return typeof t=="string"?e!==null?this.style[t]=e:this.style.cssText=t:Object.assign(this.style,t),this},attrib(t,e=null){return e!==null?(this.setAttribute(t,e),this):this.getAttribute(t)||""},clA(...t){return this.classList.add(...t),this},clR(...t){return this.classList.remove(...t),this},clT(t,e){return this.classList.toggle(t,e),this},animateFade(t,e={}){let{time:n=200,cb:r}=e,i=this,a=t===0?1:0,g=Math.min(1,Math.max(0,t)),s=performance.now();i.style.opacity=g.toString();function y(w){let J=w-s,k=Math.min(J/n,1),W=g+(a-g)*k;i.style.opacity=W.toString(),k<1?requestAnimationFrame(y):(i.style.opacity=a.toString(),r?.())}return requestAnimationFrame(y),this},fadeIn(...t){let e=P({display:"string",cb:"function",time:"number"},t),{display:n="block"}=e;return this.css("display",n),this.animateFade(0,e),this.fade=!0,this},fadeOut(...t){let e=P({cb:"function",time:"number"},t),n=e.time??300;return e.time=n,this.animateFade(1,{...e,cb:()=>{this.css("display","none"),e.cb?.()}}),this.fade=!1,this},async fadeInP(...t){return new Promise(e=>{this.fadeIn(...t,()=>e(this))})},async fadeOutP(...t){return new Promise(e=>{this.fadeOut(...t,()=>e(this))})},fade:!0,fadeToggle(){return this.fade?this.fadeOut():this.fadeIn(),this},add(t){return this.appendChild(t),this},addUp(t){return this.insertBefore(t,this.firstChild),this},qs(t,e=0){return e&&(t=`[data-id="${t}"]`),this.querySelector(t)}};f.qi=f.qs;function P(t,e){let n={};if(e.length===0)return n;if(e.every(r=>typeof r=="object"))return Object.assign({},...e);for(let r of e)for(let[i,a]of Object.entries(t))if(typeof r===a){n[i]=r;break}return n}Object.assign(HTMLElement.prototype,f);Object.assign(document,f);Object.assign(document.body,f);Object.assign(document.documentElement,f);window.qs=window.qi=f.qs.bind(document);b();l.hooks={onEnd(t,e,n,r){console.log("[VQL]",t,e,n,r)},onError(t,e,n,r){console.error("[VQL]",t,e,n,r)}};var ct=new URLSearchParams(window.location.search);ct.has("skip-startup")||await H().then(()=>tt);await B().then(()=>lt);
//# sourceMappingURL=index.js.map
